<canvas id="ctx" width="500" height="500" style="border:1px solid #000000;"></canvas>

<script src="http://cdn.socket.io/socket.io-1.4.5.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
<script>
	var ctx = document.getElementById('ctx').getContext('2d');
	ctx.font = '30px Arial';

	var socket = io();

	socket.on('positionUpdate', function(data){
		ctx.clearRect(0, 0, 500, 500);
		for(var i = 0; i < data.player.length; i++){
			ctx.fillStyle = 'blue';
			ctx.fillRect(data.player[i].x, data.player[i].y, 30, 30);
		}
		for(var i = 0; i < data.bullet.length; i++){
			ctx.fillStyle = 'blue';
			ctx.fillRect(data.bullet[i].x, data.bullet[i].y, 10, 10);
		}
	});

	document.onkeydown = function(event){
		if(event.keyCode === 87) //w
			socket.emit('keyPress', {inputId: 'up', state: true});
		if(event.keyCode === 65) //a
			socket.emit('keyPress', {inputId: 'left', state: true});
		if(event.keyCode === 83) //s
			socket.emit('keyPress', {inputId: 'down', state: true});
		if(event.keyCode === 68) //d
			socket.emit('keyPress', {inputId: 'right', state: true});
	}
	document.onkeyup = function(event){
		if(event.keyCode === 87) //w
			socket.emit('keyPress', {inputId: 'up', state: false});
		if(event.keyCode === 65) //a
			socket.emit('keyPress', {inputId: 'left', state: false});
		if(event.keyCode === 83) //s
			socket.emit('keyPress', {inputId: 'down', state: false});
		if(event.keyCode === 68) //d
			socket.emit('keyPress', {inputId: 'right', state: false});
	}

	document.onmousedown = function(event){
	  socket.emit('mousePress', {inputId: 'click', state: true})
	}
	document.onmouseup = function(event){
	  socket.emit('mousePress', {inputId: 'click', state: false})
	}
	document.onmousemove = function(event){
		socket.emit('mousePress', {
			inputId: 'move',
	  	x: (event.clientX - $("canvas").offset().left),
	  	y: (event.clientY - $("canvas").offset().top)
		});
	}

	/*
	function ctxClick(event){
		socket.emit('click',{
			mousePos: {x: event.clientX, y: event.clientY}
		});
	}
	*/
	/*
	socket.emit('happy',{
		reason: 'Test'
	});
	*/
</script>
